<!DOCTYPE html>
<html>
<head>
    <title>Cinnabar on Dolomite</title>
    <script src='scripts/jquery-2.1.0.min.js' type='text/javascript'></script>
    <script src='scripts/jquery-ui-1.10.4.custom.min.js' type='text/javascript'></script>
    <script src='scripts/knockout-3.0.0.js' type='text/javascript'></script>
    <link href='style/source_sans.css' rel='stylesheet' type='text/css' />
    <link href="style/style.css" rel="stylesheet" type='text/css'/>
</head>
<body>

<div id='modals' data-bind="visible: !loginLoggedIn() || settingsVisible() || generalError() || playlistAddModalVisible() == 'static'">
    <div id='loginForm' class="modal" data-bind="visible: loginLoggedIn() == false">
        <form>
            <h1>Login to Dolomite</h1>
            <p data-bind="text:loginNotice(), visible:loginNotice() != ''"></p>
            <label for='loginUsername'>Username:</label>
            <input type='text' data-bind="value: loginUsername" id='loginUsername' />
            <label for='loginPassword'>Password:</label>
            <input type='password' data-bind="value: loginPassword" id='loginPassword' />
            <button data-bind="click: loginSubmitLogin">Login</button>
        </form>
    </div>
    <div id='addPlaylistModal' class='modal' data-bind="visible: playlistAddModalVisible() == 'static'">
        <form>
            <h1>Add Playlist</h1>
            <label for='playlistName'>Playlist Name:</label>
            <input type='text' id='playlistName' data-bind="value: playlistAddName" />
            <button data-bind="click: submitStaticPlaylist">Add Playlist</button>
        </form>
    </div>
    <div id='settingsModal' class='modal' data-bind="visible: settingsVisible()">
        <form>
            <h1>Settings</h1>
            <div class='row'>
                <div class='colLeft'>Shuffle Mode:</div>
                <div class='colRight'>
                    <input type='radio' value='order' id='shuffleModeOrder' name='shuffleMode' data-bind="checked: settings().shuffleMode" />
                    <label for='shuffleModeOrder'>Random Order</label><br />
                    <input type='radio' value='random' id='shuffleModeRandom' name='shuffleMode' data-bind="checked: settings().shuffleMode" />
                    <label for='shuffleModeRandom'>True Random</label>
                </div>
            </div>
            <div class='row'>
                <div class='colLeft'>
                    Preferred Quality:
                </div>
                <div class='colRight'>
                    <input type='radio' value='2' name='quality' id='qualityHigh' data-bind="checked: settings().quality" />
                    <label for='qualityHigh'>High Quality (320kbps)</label><br />
                    <input type='radio' value='1' name='quality' id='qualityMed' data-bind="checked: settings().quality" />
                    <label for='qualityMed'>Medium Quality (192kbps)</label><br />
                    <input type='radio' value='0' name='quality' id='qualityLow' data-bind="checked: settings().quality" />
                    <label for='qualityLow'>Low Quality (128kbps)</label>
                </div>
            </div>
            <div class='row'>
                <div class='colLeft'>Last.fm Integration:</div>
                <div class='colRight'><span>Coming Soon</span></div>
            </div>
            <div>
                <button type='button' data-bind="click: saveSettings">Save Settings</button>
            </div>
        </form>
    </div>
    <div id='genError' class="modal" data-bind="visible: generalError() != false">
        <h1>An Error Occurred</h1>
        <p data-bind="text: generalError()"></p>
    </div>
</div>

<div id='topBar'>
    <div id='logo'>
        <img src='img/logo.png' title="Cinnabar on Dolomite" />
    </div>
    <div id='playControls'>
        <div class='button small' data-bind="click: previousTrack">
            <img src='img/back.png' alt='back' title='Previous Track' data-bind="visible: playing()" />
        </div>
        <div class='button large' data-bind="click: togglePlayback">
            <img src='img/pause.png' alt='pause' title='Play/Pause' data-bind="visible: playing() == 'playing'" />
            <img src='img/play.png' alt='play' title='Play/Pause' data-bind="visible: playing() == 'paused' || !playing()"/>
        </div>
        <div class='button small' data-bind="click: nextTrack">
            <img src='img/forward.png' alt='forward' title='Next Track' data-bind="visible: playing()" />
        </div>
    </div>
    <div id='playSlider'>
        <div id='scrubber' data-bind="visible: playing(), click: scrubberClick">
            <div id='played' data-bind="style:{width: playingProgress() + '%'}"></div>
            <div id='playedHandle'></div>
        </div>
        <div id='playInfo' data-bind="visible: playing()">
            <div id='trackInfo'>
                <span data-bind="text: playingTrack().Metadata.Title"></span> |
                <span data-bind="text: playingTrack().Metadata.Artist"></span> |
                <span data-bind="text: playingTrack().Metadata.Album"></span>
            </div>
            <div id='timeInfo'>
                <span data-bind="text: playingProgressTime"></span> /
                <span data-bind="text: calculateTrackTime(playingTrack().Metadata.Duration)"></span>
            </div>
        </div>
    </div>
    <div id='listControls'>
        <div class='button small' data-bind="click: toggleShuffle">
            <img src='img/shuffle_selected.png' alt='shuffle' title='Shuffle On/Off' data-bind="visible: shuffleEnabled()"/>
            <img src='img/shuffle.png' alt='shuffle' title='Shuffle On/Off' data-bind="visible: !shuffleEnabled()" />
        </div>
        <div class='button small' data-bind="click: toggleRepeat">
            <img src='img/repeat_selected.png' alt='repeat' title='Repeat On/Off' data-bind="visible: repeatEnabled()"/>
            <img src='img/repeat.png' alt='repeat' title='Repeat On/Off' data-bind="visible: !repeatEnabled()"/>
        </div>
    </div>
    <div id='settings'>
        <div class='button small' id='volume'>
            <img src='img/volume.png' alt='volume' title='Volume' />
            <div id='volumeBox'>
                <div id='volumeSlider'>
                    <div id='volumeHandle'></div>
                </div>
            </div>
        </div>
        <div class='button small' data-bind="click: showSettings">
            <img src='img/options.png' alt='settings' title='Settings' />
        </div>
    </div>
</div>
<div id='mainPane'>
    <div id='leftBar'>
        <div id='navBar' data-bind="css:{playing: playing() != false}">
            <ul>
                <li class='selectable' data-bind="click: showAllTracks, css:{selected: visiblePane() == 'tracks'}">Tracks</li>
                <li class='selectable' data-bind="css:{selected: visiblePane() == 'artists'}">Artists</li>
                <li class='selectable' data-bind="css:{selected: visiblePane() == 'albums'}">Albums</li>
                <li class='selectable' data-bind="css:{selected: visiblePane() == 'genres'}">Genres</li>
                <li>
                    Auto Playlists
                    <button class='addButton' title='Add Auto Playlist' data-bind="click: showAddAutoPlaylist">
                        <img src='img/plus.png' alt='+' />
                    </button>
                    <ul data-bind="foreach: navAutoPlaylists()">
                        <li class='selectable' data-bind="text: Name, click: $root.loadPlaylist.bind($data, 'auto'), css:{selected: $root.visiblePane() == 'auto' + Id}"></li>
                    </ul>
                </li>
                <li>
                    Playlists
                    <button class='addButton' title='Add Playlist' data-bind="click: showAddStaticPlaylist">
                        <img src='img/plus.png' alt='+' />
                    </button>
                    <ul data-bind="foreach: navStaticPlaylists()">
                        <li class='selectable' data-bind="text: Name, click: $root.loadPlaylist.bind($data, 'static'), css:{selected: $root.visiblePane() == 'static' + Id}"></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id='albumArt' data-bind="visible: playing() != false && playingTrack().ArtHref != null">
            <img data-bind="attr:{src: playingTrack().ArtHref != null ? playingArt() : ''}" />
        </div>
    </div>
    <div id='infoBar' style='height:48px; background-color:#0055d4;'>
        <span>
            <span data-bind="text: infoTotalTracks()"></span>
            Tracks |
            <span data-bind="text: infoTotalTime()"></span>
        </span>
        <input type='text' placeholder="Search Tracks"/>
    </div>
    <div id='autoPlaylistPane' class='pane' data-bind="visible: visiblePane() == 'addAutoPlaylist'">
        <form>
            <h1>Add Auto Playlist</h1>
            <div class='row'>
                <div class='colLeft tall'>
                    <label for='aPlaylistName'>Playlist Name:</label>
                </div>
                <div class='colRight'>
                    <input type='text' id='aPlaylistName' data-bind="value: playlistAddName" />
                </div>
            </div>
            <div class='row'>
                <div class='colLeft label'>Playlist Rules:</div>
                <div class='colRight'>
                    <table class="collapse">
                        <thead>
                        <tr>
                            <th style='width: 31%'>Field</th>
                            <th style='width: 31%'>Comparison</th>
                            <th style='width: 31%'>Value</th>
                            <th style='width: 7%'></th>
                        </tr>
                        </thead>
                        <tbody data-bind="foreach: playlistAddRules">
                        <tr>
                            <td>
                                <select data-bind="options: metadataFields, optionsText: 'DisplayName', optionsCaption: 'Select...', value: metadataField"></select>
                            </td>
                            <td data-bind="with: metadataField">
                                <select data-bind="options: $parent.comparisonOptions, optionsText: 'DisplayName', optionsCaption: 'Select...', value: $parent.comparison"></select>
                            </td>
                            <td data-bind="with: comparison">
                                <input type='text' data-bind="value: $parent.value"/>
                            </td>
                            <td class='centerText'>
                                <a href='#' data-bind="click: $root.autoPlaylistRemoveRule"><img src='img/trash.png' alt='Remove' /></a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <button data-bind="click: autoPlaylistAddRule" style='margin-top: 7px;'>Add Rule</button>
                </div>
            </div>
            <div class='row'>
                <div class='colLeft tall'>
                    <label for='anyAll'>Match Mode:</label>
                </div>
                <div class='colRight'>
                    <select name='anyAll' id='anyAll' data-bind="value: playlistAddAnyAll">
                        <option value='any'>Any</option>
                        <option value='all'>All</option>
                    </select>
                </div>
            </div>
            <div class='row'>
                <div class='colLeft'>
                    <label for='applyLimit'>Limit Matching Tracks:</label>
                </div>
                <div class='colRight'>
                    <input type='checkbox' id='applyLimit' data-bind="checked: playlistAddApplyLimit">
                </div>
            </div>
            <div class='row' data-bind="visible: playlistAddApplyLimit">
                <div class='colLeft tall'>
                    <label for='limitCount'>Max Tracks:</label>
                </div>
                <div class='colRight'>
                    <input type='text' id='limitCount' data-bind="value: playlistAddLimitCount" style='width:164px;'>
                </div>
            </div>
            <div class='row' data-bind="visible: playlistAddApplyLimit">
                <div class='colLeft tall'>
                    <label for='limitField'>Order By:</label>
                </div>
                <div class='colRight'>
                    <select data-bind="options: metadataFields, optionsText: 'DisplayName', optionsCaption: 'Random', value: playlistAddLimitField" id='limitField'></select>
                </div>
            </div>
            <div class='row' data-bind="visible: playlistAddLimitField() != null">
                <div class='colLeft'>
                    <label for='limitDesc'>Descending Order:</label>
                </div>
                <div class='colRight'>
                    <input type='checkbox' data-bind="checked: playlistAddLimitDesc" id='limitDesc' />
                </div>
            </div>
            <button data-bind="click: submitAutoPlaylist">Add Playlist</button>
            <button data-bind="click: cancelAutoPlaylist">Cancel</button>
        </form>
    </div>
    <div id='trackPane' data-bind="visible: visiblePane() == 'tracks' || visiblePane().startsWith('auto') || visiblePane().startsWith('static')">
        <div>
            <table>
                <thead>
                    <tr>
                        <th><img src='img/play_small.png' alt='Play' /></th>
                        <th>Track #</th>
                        <th>Title</th>
                        <th>Time</th>
                        <th>Artist</th>
                        <th>Album</th>
                        <th>Year</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: trackVisibleTracks()">
                    <tr data-bind="event:{mouseover: $root.trackHover.bind($data, 'start'), mouseout: $root.trackHover.bind($data, 'end'), dblclick: $root.manualPlay}, dblclickBubble: false">
                        <td class='playIndicator'>
                            <span class='playIndicatorPlaying' data-bind="click: $root.manualPlay, visible: $root.playingPane() == $root.visiblePane() && $root.playingTrack().Id == Id">
                                <img src='img/play_small.png' alt='Play' title='Play'/>
                            </span>
                            <span class='playIndicatorHover' data-bind="click: $root.manualPlay, visible: $root.playingTrack().Id != Id">
                                <img src='img/play_small.png' alt='Play' title='Play' />
                            </span>
                        </td>
                        <td data-bind="text: calculateTrackNumber(Metadata['Track Number'],Metadata['Disc Number'])"></td>
                        <td data-bind="text: Metadata.Title"></td>
                        <td data-bind="text: calculateTrackTime(Metadata.Duration)"></td>
                        <td data-bind="text: Metadata.Artist"></td>
                        <td data-bind="text: Metadata.Album"></td>
                        <td data-bind="text: Metadata.Year"></td>
                        <td data-bind="click: $root.enqueueTrack">EQ</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
<script src='scripts/app.js' type='text/javascript'></script>
</html>